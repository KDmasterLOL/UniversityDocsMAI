mixin collapse
	span.collapsible_toggle&attributes(attributes)
	span.collapsible
		block
mixin math
	- var oldBuf = pug_html;
	- pug_html = '';
	Math
		block
	- pug_html = oldBuf + pug_html.replace(/\${1,2}(?!lib)[^$]+\${1,2}/g, (body)=> '{@html math(`'+body.replaceAll('$','')+'`)}');
	//- - pug_html = oldBuf + pug_html.replace(/\${1,2}(?!lib)[^$]+\${1,2}/g, (body)=> body.replaceAll('{','&lcub;').replaceAll('{','&rcub;').replaceAll('<','\\lt').replaceAll('>','\\gt'));
mixin m
	- var oldBuf = pug_html;
	- pug_html = '';
	block
	- secBuf = pug_html;
	- pug_html = '';
	- props = {}
	- props.macros = { '\\dd': '\\text{d}#1','\\ddv': '\\frac{\\dd{#1}}{\\dd{#2}}', '\\same':String.raw`\left\{#1\mathbb{=}#2\right\}` }
	- props.displayMode =  attributes.class && attributes.class.includes("block")
	- props.throwOnError = false
	- props = JSON.stringify(props)
	| {@html katex.renderToString(String.raw`#{secBuf.replaceAll("`",'\\prime')}`, !{props})}
	- pug_html = oldBuf + pug_html

	if where
		span
			| (
			each val,index in where
				span #[+m= index] #[span= ': ' + val + ', '] 
			| )
	if attributes.block
		span this block

mixin source(links=[])
	each link in links
		a(href=link)